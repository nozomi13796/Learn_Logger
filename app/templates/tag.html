{% extends "base.html" %}
{% block title %}#{{ tag.name }}{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto mt-10">

  <h2 class="text-3xl font-bold mb-6">
    #{{ tag.name }}
    <span class="text-sm text-gray-500 ml-2">
      total: {{ total_minutes }} minutes
    </span>
  </h2>

  {% for i in posts %}
  <div class="card bg-base-100 shadow mb-6 border border-base-300">
    <div class="card-body">

      <!-- Title + Edit/Delete -->
      <div class="flex justify-between items-center">
        <h3 class="card-title">{{ i.title }}</h3>

        <div class="flex gap-2">
          <a href="{{ url_for('blog.update_post', pid=i.pid) }}" class="btn btn-sm btn-primary">Edit</a>
          <a href="{{ url_for('blog.delete_post', pid=i.pid) }}" class="btn btn-sm btn-error">Delete</a>
        </div>
      </div>

      <!-- Author -->
      <p class="text-sm text-gray-500">
        BY: {{ i.user.username }}
      </p>

      <!-- Description -->
      <div class="prose max-w-none mt-3">
        {{ i.description | markdown | safe }}
      </div>

      <!-- Date + Minutes -->
      <div class="text-right text-sm text-gray-500 mt-4">
        {{ i.created_at }} → {{ i.study_minutes }} 分
      </div>

      <!-- Tags -->
      <div class="mt-3 flex flex-wrap gap-2">
        {% for tag in i.tags %}
        <a href="{{ url_for('blog.show_tag', name=tag.name) }}" class="badge badge-primary">
          #{{ tag.name }}
        </a>
        {% endfor %}
      </div>

    </div>
  </div>
  {% endfor %}

</div>
{% endblock %}
